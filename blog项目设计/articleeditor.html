<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>YD-新增博文</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <!-- Custom Font Icons CSS-->
    <link rel="stylesheet" href="css/font.css">
    <!-- Google fonts - Muli-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:300,400,700">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="css/custom.css">
    <!-- Favicon-->
    <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->

    <script src="langs/zh_CN.js"></script>
    <script src='https://cdn.tiny.cloud/1/a8d92we1tujwpoglwnjyyzq49k05a70pi119dqj1ry8dygy1/tinymce/5/tinymce.min.js' referrerpolicy="origin"></script>

    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->


</head>
<body>
<header class="header">
    <nav class="navbar navbar-expand-lg">
        <div class="search-panel">
            <div class="search-inner d-flex align-items-center justify-content-center">
                <div class="close-btn">Close <i class="fa fa-close"></i></div>
                <form id="searchForm" action="#">
                    <div class="form-group">
                        <input type="search" name="search" placeholder="What are you searching for...">
                        <button type="submit" class="submit">Search</button>
                    </div>
                </form>
            </div>
        </div>
        <div class="container-fluid d-flex align-items-center justify-content-between">
            <div class="navbar-header">
                <!-- Navbar Header--><a href="index.html" class="navbar-brand">
                <div class="brand-text brand-big visible text-uppercase"><strong class="text-primary">Yd</strong><strong>Blog</strong></div>
                <div class="brand-text brand-sm"><strong class="text-primary">Y</strong><strong>D</strong></div></a>
                <!-- Sidebar Toggle Btn-->
                <button class="sidebar-toggle"><i class="fa fa-long-arrow-left"></i></button>
            </div>
            <div class="right-menu list-inline no-margin-bottom">
                <!-- Log out -->
                <div class="list-inline-item logout"><a id="logout" href="login.html" class="nav-link"> <span class="d-none d-sm-inline">Logout </span><i class="icon-logout"></i></a></div>
            </div>
        </div>
    </nav>
</header>
<div class="d-flex align-items-stretch">
    <!-- Sidebar Navigation-->
    <nav id="sidebar">
        <!-- Sidebar Header-->
        <div class="sidebar-header d-flex align-items-center">
            <div class="avatar"><img src="img/avatar-6.jpg" alt="..." class="img-fluid rounded-circle"></div>
            <div class="title">
                <h1 class="h5">Mark Stephen</h1>
                <p>Web Designer</p>
            </div>
        </div>
        <!-- Sidebar Navidation Menus--><span class="heading">Main</span>
        <ul class="list-unstyled">
            <li ><a href="manage.html"> <i class="icon-home"></i>后台首页</a></li>
            <li><a href="article.html"> <i class="icon-grid"></i>博文管理</a></li>

            <li><a href="uers.html"> <i class="icon-padnote"></i>用户管理</a></li>
            <li  class="active"><a href="articleeditor.html"> <i class="icon-grid"></i>博文新增</a></li>
        </ul><span class="heading">BlogMain</span>
        <ul class="list-unstyled">
            <li> <a href="index.html"> <i class="icon-writing-whiteboard"></i>博客首页</a></li>
            <li> <a href="web.html"> <i class="icon-writing-whiteboard"></i>前端分享</a></li>
            <li> <a href="data.html"> <i class="icon-writing-whiteboard"></i>数据结构</a></li>
            <li> <a href="algorithm.html"> <i class="icon-writing-whiteboard"></i>算法</a></li>
        </ul>
    </nav>
    <!-- Sidebar Navigation end-->
    <div class="page-content">
        <div class="page-header">
            <div class="container-fluid">
                <h2 class="h5 no-margin-bottom">Article</h2>
            </div>
        </div>
        <section class="no-padding-top">
            <div class="col-md-3" >
                <div class="form-group">
                    <label class="form-control-label" >articleType&nbsp;&nbsp;&nbsp;</label>
                    <div class='input-group'>
                        <input type='text' class="form-control articleCid" />
                        <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-control-label" >articleName</label>
                    <input type="text" placeholder="articleName" class="form-control" id="articleTitle">
                </div>

                <div class="form-group ">
                    <label class="form-control-label">articleDetails</label>
                    <textarea class="form-control" rows="5" id="articleDesc"></textarea>
                </div>
                <div class="col-lg-12 form-group">
                    <div class="form-group">
                        <label class="asd">选择日期：</label>
                        <!--指定 date标记-->
                        <div class='input-group date' id='datetimepicker3'>
                            <input type='text' class="form-control data" />
                            <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <form method="post">
                    <textarea id="mytextarea" name="mytextarea"></textarea>
                </form>
                <div class="form-group">
                    <input type="submit" value="Add article" class="btn btn-primary" style="margin-top: 1rem">
                </div>
            </div>
        </section>
        <footer class="footer">
            <div class="footer__block block no-margin-bottom">
                <div class="container-fluid text-center">
                    <p>&nbsp;&nbsp;&nbsp;&nbsp;Copyright &copy; 2020.Company name All rights reserved.&nbsp; &nbsp; &nbsp; 备案号：<a>粤ICP备19142749号</a></p>
                </div>
            </div>
        </footer>
    </div>
</div>
<!-- JavaScript files-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/popper.js/umd/popper.min.js"> </script>
<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
<script src="vendor/chart.js/Chart.min.js"></script>
<script src="vendor/jquery-validation/jquery.validate.min.js"></script>
<script src="js/charts-home.js"></script>
<script src="js/front.js"></script>
</body>
</html>
<script>

    tinymce.init({
        selector: '#mytextarea',
        plugins : 'advlist autolink link image lists preview code codesample emoticons',
        toolbar: 'undo redo | styleselect | bold italic | link image | code | advlist | autolink | lists | bullist| numlist  |preview | table tabledelete | codesample | emoticons',
        language_url : 'langs/zh_CN.js',
        language:'zh_CN',//注意大小写
        height: 600,
        images_upload_handler: function (blobInfo, succFun, failFun) {
            var xhr, formData;
            var file = blobInfo.blob();//转化为易于理解的file对象
            xhr = new XMLHttpRequest();
            xhr.withCredentials = false;
            xhr.open('POST', '/publish/picture/upload');
            xhr.onload = function() {
                var json;
                if (xhr.status != 200) {
                    failFun('HTTP Error: ' + xhr.status);
                    return;
                }
                json = JSON.parse(xhr.responseText);
                console.log(json);
                if (!json || typeof json.location != 'string') {
                    failFun('Invalid JSON: ' + xhr.responseText);
                    return;
                }
                console.log(json.location);
                succFun(json.location);
            };
            formData = new FormData();
            formData.append('file', file, file.name );//此处与源文档不一样
            xhr.send(formData);
            console.log(formData);
        },
    });

    var tinyID='mytextarea';

    function getContent(){
        console.log("11111")
        //时间
        var articleTime = $(".data").val();
        // articleTime = articleTime.toString();

        //名字
        var articleTitle = $("#articleTitle").val();
        // articleTitle = articleTitle.toString();


        //内容
        var articleContent = tinyMCE.editors[tinyID].getContent();
        // articleContent = articleContent.toString();

        //类型
        var articleCid = $(".articleCid").val();
        // articleCid = toString(articleCid);

        //简介
        var articleDesc = $("#articleDesc").val();
        // articleDesc = toString(articleDesc);
        $.ajax({
            url: '/publish/article',
            type: 'post',
            data: {articleContent:articleContent,articleDesc: articleDesc,articleTime:articleTime, articleCid:articleCid,articleTitle:articleTitle},
            dataType: 'json',
            success: function (data) {
                alert("新增成功");
            },
            error: function (res, error) {
                alert("链接出错");
            }
        })
    }
    var btn1 = document.querySelector('.btn-primary');
    btn1.onclick =getContent;

    ////时间插件



</script>
